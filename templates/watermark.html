{% extends "base.html" %}

{# --- ENHANCED SEO BLOCKS START --- #}
{% block title %}Watermark Maker – ImgCraft{% endblock %}

{% block meta_description %}Add custom text or logo watermarks to photos. Protect your images with adjustable
transparency, position, and rotation.{% endblock %}

{% block meta_keywords %}add watermark online free, watermark photos, copyright image tool, logo watermark maker, text
watermark creator, protect photos online, add copyright to image, watermark generator, photo protection tool, brand
watermark, photographer watermark, artist signature tool, image copyright protection, batch watermark images, custom
watermark maker, transparent watermark, watermark position control, rotate watermark, watermark opacity, add logo to
photo, copyright text overlay, photography watermark, digital signature tool, protect artwork online, watermark for
instagram, watermark for portfolio, prevent image theft, image ownership protection, professional watermark tool, custom
font watermark, watermark with transparency, corner watermark, center watermark, diagonal watermark, subtle watermark,
visible watermark, watermark for social media, watermark for website, protect digital art, brand identity watermark,
imgcraft watermark{% endblock %}

{% block og_title %}Watermark Maker – ImgCraft{% endblock %}

{% block og_description %}Protect your photos with custom watermarks. Professional tool for photographers and artists
with no output watermark.{% endblock %}
{# --- ENHANCED SEO BLOCKS END --- #}

{% block content %}
<div class="studio-wrapper">

    <aside class="studio-panel studio-panel-left glass-panel">
        <div class="panel-header">
            <h3><i class="fas fa-info-circle"></i> Source File</h3>
        </div>

        <div class="panel-content custom-scrollbar">
            <div id="fileInfoSection" style="display: none;">
                <div class="file-info-section">
                    <div class="file-info-row">
                        <span class="file-info-label">Name:</span>
                        <span class="file-info-value" id="fileName">-</span>
                    </div>
                    <div class="file-info-row">
                        <span class="file-info-label">Size:</span>
                        <span class="file-info-value" id="fileSize">-</span>
                    </div>
                    <div class="file-info-row">
                        <span class="file-info-label">Dimensions:</span>
                        <span class="file-info-value" id="fileDimensions">-</span>
                    </div>
                </div>

                <!-- Web-Ready Score -->
                <div class="file-info-row web-ready-score-row" id="webReadyScoreRow" style="display: none;">
                    <div class="score-display">
                        <svg class="score-ring" id="scoreRing" viewBox="0 0 60 60"></svg>
                        <div>
                            <div class="file-info-label">Web-Ready Score</div>
                            <div class="score-value" id="scoreValue">--</div>
                        </div>
                    </div>
                    <div class="score-tips" id="scoreTips"></div>
                </div>

                <hr class="panel-divider">

                <div class="info-card-small">
                    <i class="fas fa-mouse-pointer"
                        style="color: var(--primary); font-size: 1.2rem; margin-bottom: 8px;"></i>
                    <p><strong>Interactive Canvas:</strong><br>You can drag the watermark directly on the image to
                        position it.</p>
                </div>
            </div>

            <div class="info-box-empty" id="startInfoLeft">
                <i class="fas fa-image"></i>
                <p>Upload base image</p>
            </div>
        </div>
    </aside>


    <main class="studio-canvas">
        <div class="canvas-container">

            <div class="upload-area-large" id="dropZone">
                <div class="upload-content">
                    <div class="upload-icon-large floating-anim"><i class="fas fa-copyright"></i></div>
                    <h2>Watermark Image</h2>
                    <p class="text-muted">Drag & drop JPG, PNG, or WebP</p>
                    <button class="btn btn-primary mt-4" onclick="document.getElementById('fileInput').click()">
                        Browse Files
                    </button>
                    <input type="file" id="fileInput" hidden accept="image/*">
                </div>
            </div>

            <div class="preview-stage" id="previewContainer" style="display: none;">
                <div class="watermark-canvas-wrapper">
                    <canvas id="watermarkCanvas"></canvas>
                </div>

                <div class="progress-container-floating" id="loadingOverlay" style="display: none;">
                    <div class="loader-spinner"></div>
                    <p class="progress-text">Processing...</p>
                </div>
            </div>

        </div>
    </main>


    <aside class="studio-panel studio-panel-right glass-panel">
        <div class="panel-header">
            <h3><i class="fas fa-sliders-h"></i> Configuration</h3>
            <div class="badge badge-pro">PRO</div>
        </div>

        <div class="panel-content custom-scrollbar">

            <div id="watermarkControls" style="display: none;">

                <div class="control-section">
                    <label class="section-label">Watermark Type</label>
                    <div class="mode-switcher">
                        <button class="mode-btn active" id="typeText" onclick="setWatermarkType('text')">
                            <i class="fas fa-font"></i> Text
                        </button>
                        <button class="mode-btn" id="typeImage" onclick="setWatermarkType('image')">
                            <i class="fas fa-image"></i> Image
                        </button>
                    </div>
                </div>

                <hr class="panel-divider">

                <div id="textControls">
                    <div class="control-section">
                        <label class="section-label">Content</label>
                        <div class="input-wrapper mb-3">
                            <input type="text" id="watermarkText" value="© ImgCraft" placeholder="Enter text...">
                        </div>

                        <div class="custom-select mb-3" id="fontFamilyDropdown">
                            <div class="select-trigger">
                                <span id="fontFamilyText">Arial</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="select-options" id="fontFamilyOptions">
                                <div class="option selected" data-value="Arial">Arial</div>
                                <div class="option" data-value="Times New Roman">Times New Roman</div>
                                <div class="option" data-value="Courier New">Courier New</div>
                                <div class="option" data-value="Georgia">Georgia</div>
                                <div class="option" data-value="Verdana">Verdana</div>
                                <div class="option" data-value="Impact">Impact</div>
                            </div>
                            <input type="hidden" id="fontFamily" value="Arial">
                        </div>

                        <div class="style-grid">
                            <button class="style-btn" id="fontBold" onclick="toggleBold()"><i
                                    class="fas fa-bold"></i></button>
                            <button class="style-btn" id="fontItalic" onclick="toggleItalic()"><i
                                    class="fas fa-italic"></i></button>
                            <div class="color-input-wrapper">
                                <input type="color" id="fontColor" value="#ffffff" title="Text Color">
                            </div>
                        </div>
                    </div>

                    <div class="control-section mt-3">
                        <div class="slider-group-compact">
                            <div class="slider-label"><span>Font Size</span> <span class="val"
                                    id="fontSizeValue">40</span></div>
                            <input type="range" id="fontSize" class="range-slider" min="10" max="200" value="40">
                        </div>
                    </div>
                </div>

                <div id="imageControls" style="display: none;">
                    <div class="control-section">
                        <label class="section-label">Upload Logo</label>
                        <div class="upload-btn-wrapper">
                            <button class="btn btn-outline btn-full"
                                onclick="document.getElementById('watermarkImageInput').click()">
                                <i class="fas fa-upload"></i> Choose Image
                            </button>
                            <input type="file" id="watermarkImageInput" accept="image/*" hidden>
                        </div>
                        <p class="text-xs text-muted mt-2 text-center" id="watermarkImageName">No file selected</p>
                    </div>
                </div>

                <hr class="panel-divider">

                <div class="control-section">
                    <label class="section-label">Appearance</label>

                    <div class="slider-group-compact">
                        <div class="slider-label"><span>Opacity</span> <span class="val" id="opacityValue">70%</span>
                        </div>
                        <input type="range" id="opacity" class="range-slider" min="0" max="100" value="70">
                    </div>

                    <div class="slider-group-compact">
                        <div class="slider-label"><span>Scale</span> <span class="val" id="scaleValue">100%</span></div>
                        <input type="range" id="scale" class="range-slider" min="10" max="200" value="100">
                    </div>

                    <div class="slider-group-compact">
                        <div class="slider-label"><span>Rotation</span> <span class="val" id="rotationValue">0°</span>
                        </div>
                        <input type="range" id="rotation" class="range-slider" min="-180" max="180" value="0">
                    </div>
                </div>

                <hr class="panel-divider">

                <div class="control-section">
                    <label class="section-label">Quick Position</label>
                    <div class="position-grid">
                        <button class="pos-btn" onclick="setPosition('top-left')">↖</button>
                        <button class="pos-btn" onclick="setPosition('top-center')">↑</button>
                        <button class="pos-btn" onclick="setPosition('top-right')">↗</button>
                        <button class="pos-btn" onclick="setPosition('center-left')">←</button>
                        <button class="pos-btn" onclick="setPosition('center')">●</button>
                        <button class="pos-btn" onclick="setPosition('center-right')">→</button>
                        <button class="pos-btn" onclick="setPosition('bottom-left')">↙</button>
                        <button class="pos-btn" onclick="setPosition('bottom-center')">↓</button>
                        <button class="pos-btn active" onclick="setPosition('bottom-right')">↘</button>
                    </div>
                </div>

            </div>

            <div class="info-box-empty" id="startInfoRight">
                <i class="fas fa-sliders-h"></i>
                <p>Settings will appear here</p>
            </div>

        </div>

        <div class="panel-footer">
            <div class="cost-indicator">
                <i class="fas fa-coins"></i> 3 credits
            </div>

            <button class="btn btn-primary btn-full" id="applyBtn" disabled>
                Apply & Download
            </button>

            <div id="downloadArea" class="action-stack" style="display: none; margin-top: 10px;">
                <a id="downloadBtn" class="btn btn-primary btn-full btn-glow">
                    <i class="fas fa-download"></i> Download Result
                </a>
                <button class="btn btn-outline btn-full mt-2" onclick="resetWatermark()">
                    <i class="fas fa-undo"></i> Reset
                </button>
                <button class="btn btn-text mt-2" style="width:100%;" onclick="location.reload()">
                    New Image
                </button>
            </div>
        </div>
    </aside>

</div>

<div id="resetModal" class="custom-modal-overlay" style="display: none;">
    <div class="custom-modal-content glass-panel">
        <div class="modal-icon-wrapper">
            <i class="fas fa-exclamation-triangle"></i>
        </div>
        <h3>Reset Settings?</h3>
        <p>This will reset all watermark customizations to default.</p>
        <div class="modal-actions">
            <button class="btn btn-outline" onclick="closeResetModal()">Cancel</button>
            <button class="btn btn-primary" onclick="confirmReset()">Yes, Reset</button>
        </div>
    </div>
</div>

{% endblock %}
{% block scripts %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/watermark.css') }}?v=1">
<script src="{{ url_for('static', filename='js/watermark.js') }}?v=1"></script>
{% endblock %}