{% extends "base.html" %}

{# --- SEO BLOCKS START --- #}
{% block title %}Crop Image Online - Free Photo Cropper (16:9, 1:1, 4:5) | ImgCraft{% endblock %}

{% block meta_description %}Crop images online for free. Use preset aspect ratios (16:9, 1:1, 9:16) for Instagram,
YouTube, and Facebook. Rotate, flip, and resize photos instantly.{% endblock %}

{% block meta_keywords %}crop image online, photo cropper, cut photo, resize image canvas, instagram crop tool, 16:9
aspect ratio, image trimmer, rotate image, imgcraft{% endblock %}

{% block og_title %}Precision Image Cropper - Crop, Rotate & Flip Online{% endblock %}
{% block og_description %}Easily crop photos to any dimension or aspect ratio. Perfect for social media posts, profile
pictures, and banners. Free and secure.{% endblock %}
{# --- SEO BLOCKS END --- #}

{% block content %}
<div class="studio-wrapper">

    <aside class="studio-panel studio-panel-left glass-panel">
        <div class="panel-header">
            <h3><i class="fas fa-ruler-combined"></i> Dimensions</h3>
        </div>

        <div class="panel-content custom-scrollbar">

            <div class="control-section">
                <label class="section-label">Aspect Ratio</label>
                <div class="aspect-grid">
                    <button class="aspect-btn active" data-ratio="free">Free</button>
                    <button class="aspect-btn" data-ratio="1:1">1:1</button>
                    <button class="aspect-btn" data-ratio="16:9">16:9</button>
                    <button class="aspect-btn" data-ratio="4:3">4:3</button>
                    <button class="aspect-btn" data-ratio="9:16">9:16</button>
                    <button class="aspect-btn" data-ratio="custom">Custom</button>
                </div>
            </div>

            <div id="customInputs" style="display: none; margin-top: 15px;">
                <label class="section-label">Custom Size (px)</label>
                <div style="display: flex; gap: 10px;">
                    <div class="input-wrapper">
                        <input type="number" id="customWidth" placeholder="W">
                        <span class="unit">px</span>
                    </div>
                    <div class="input-wrapper">
                        <input type="number" id="customHeight" placeholder="H">
                        <span class="unit">px</span>
                    </div>
                </div>
            </div>

            <hr class="panel-divider">

            <div id="fileInfoDisplay" style="display: none;">
                <label class="section-label">File Details</label>
                <div class="file-meta-row">
                    <span class="label">Name:</span>
                    <span class="value" id="fileName">-</span>
                </div>
                <div class="file-meta-row">
                    <span class="label">Size:</span>
                    <span class="value" id="fileSize">-</span>
                </div>
                <div class="file-meta-row">
                    <span class="label">Dimensions:</span>
                    <span class="value" id="fileDimensions">-</span>
                </div>
            </div>

            <div class="info-box-empty" id="startInfoLeft">
                <i class="fas fa-crop"></i>
                <p>Upload to start cropping</p>
            </div>
        </div>
    </aside>


    <main class="studio-canvas">
        <div class="canvas-container">

            <div class="upload-area-large" id="dropZone">
                <div class="upload-content">
                    <div class="upload-icon-large floating-anim"><i class="fas fa-crop-alt"></i></div>
                    <h2>Crop Image</h2>
                    <p class="text-muted">Drag & drop JPG, PNG, or WebP</p>
                    <button class="btn btn-primary mt-4" onclick="document.getElementById('fileInput').click()">
                        Browse Files
                    </button>
                    <input type="file" id="fileInput" hidden accept="image/*">
                </div>
            </div>

            <div class="preview-stage" id="editorContainer" style="display: none;">
                <div class="crop-canvas-wrapper">
                    <div class="ai-scan-overlay" id="scanOverlay"></div>
                    <canvas id="cropCanvas"></canvas>
                </div>

                <div class="zoom-pill">
                    <button class="zoom-btn" id="zoomOut"><i class="fas fa-minus"></i></button>
                    <span id="zoomLevel">100%</span>
                    <button class="zoom-btn" id="zoomIn"><i class="fas fa-plus"></i></button>
                    <div class="divider"></div>
                    <button class="zoom-btn" id="panToggle" title="Pan Mode">
                        <i class="fas fa-hand-paper"></i>
                    </button>
                </div>
            </div>

            <div class="preview-stage" id="resultContainer" style="display: none;">
                <div class="collage-preview-wrapper">
                    <img id="croppedResult" class="collage-image" src="" alt="Cropped Result">
                </div>
            </div>

        </div>
    </main>


    <aside class="studio-panel studio-panel-right glass-panel">
        <div class="panel-header">
            <h3><i class="fas fa-sliders-h"></i> Tools</h3>
            <div class="badge badge-pro">PRO</div>
        </div>

        <div class="panel-content custom-scrollbar">

            <div id="cropControls" style="display: none;">
                <div class="control-section">
                    <label class="section-label">Transform</label>
                    <div class="tool-grid">
                        <button class="tool-btn" id="rotateLeft" title="Rotate Left -90°"><i
                                class="fas fa-undo"></i></button>
                        <button class="tool-btn" id="rotateRight" title="Rotate Right +90°"><i
                                class="fas fa-redo"></i></button>
                        <button class="tool-btn" id="flipH" title="Flip Horizontal"><i
                                class="fas fa-arrows-alt-h"></i></button>
                        <button class="tool-btn" id="flipV" title="Flip Vertical"><i
                                class="fas fa-arrows-alt-v"></i></button>
                    </div>
                </div>

                <hr class="panel-divider">

                <div class="control-section">
                    <label class="section-label">Grid Overlay</label>
                    <div class="tool-grid">
                        <button class="tool-btn active" id="gridRuleThirds" title="Rule of Thirds"><i
                                class="fas fa-th"></i></button>
                        <button class="tool-btn" id="gridGolden" title="Golden Ratio"><i
                                class="fas fa-border-all"></i></button>
                        <button class="tool-btn" id="gridNone" title="No Grid"><i class="fas fa-square"></i></button>
                    </div>
                </div>
            </div>

            <div class="info-box-empty" id="startInfoRight">
                <i class="fas fa-tools"></i>
                <p>Tools will appear here</p>
            </div>

        </div>

        <div class="panel-footer">
            <div class="cost-indicator">
                <i class="fas fa-coins"></i> 1 credit
            </div>

            <button class="btn btn-primary btn-full" id="cropBtn" disabled>
                Apply Crop
            </button>

            <div id="downloadArea" class="action-stack" style="display: none;">
                <a id="downloadBtn" class="btn btn-primary btn-full btn-glow" style="margin-bottom: 12px;">
                    <i class="fas fa-download"></i> Download
                </a>
                <button id="resetBtn" class="btn btn-outline btn-full">
                    <i class="fas fa-undo"></i> Crop Again
                </button>
                <button class="btn btn-text mt-2"
                    style="width:100%; text-align:center; color: var(--text-muted); background: none; border: none; cursor: pointer;"
                    onclick="location.reload()">New Image</button>
            </div>
        </div>
    </aside>
    
</div>
{% if not user_ad_free %}
<section class="ads-section">
    <div class="ad-container">
        <!-- ImgCraft: Ad Placement - Crop Tool -->
        <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5547900968688861"
            data-ad-slot="XXXXXXXXXX" data-ad-format="auto" data-full-width-responsive="true"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
</section>
{% endif %}

<!-- Reset Modal -->
<div id="resetModal" class="custom-modal-overlay" style="display: none;">
    <div class="custom-modal-content glass-panel">
        <div class="modal-icon-wrapper">
            <i class="fas fa-exclamation-triangle"></i>
        </div>
        <h3>Reset Crop?</h3>
        <p>Are you sure you want to reset to the original image? All crop adjustments will be lost.</p>
        <div class="modal-actions">
            <button id="btnCancelReset" class="btn btn-outline">Cancel</button>
            <button id="btnConfirmReset" class="btn btn-danger">Yes, Reset</button>
        </div>
    </div>
</div>



{% endblock %}

{% block scripts %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/crop.css') }}?v=1">
<script src="{{ url_for('static', filename='js/crop.js') }}?v=1"></script>
{% endblock %}